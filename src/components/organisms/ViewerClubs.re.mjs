// Generated by ReScript, PLEASE EDIT WITH CARE

import * as Caml_int32 from "rescript/lib/es6/caml_int32.js";
import * as Caml_option from "rescript/lib/es6/caml_option.js";
import * as Core__Array from "@rescript/core/src/Core__Array.re.mjs";
import * as Core__Option from "@rescript/core/src/Core__Option.re.mjs";
import * as JsxRuntime from "react/jsx-runtime";
import * as RescriptRelay_Fragment from "rescript-relay/src/RescriptRelay_Fragment.re.mjs";
import * as ViewerClubs_viewer_graphql from "../../__generated__/ViewerClubs_viewer_graphql.re.mjs";

import { t } from '@lingui/macro'
;

var convertFragment = ViewerClubs_viewer_graphql.Internal.convertFragment;

function use(fRef) {
  return RescriptRelay_Fragment.useFragment(ViewerClubs_viewer_graphql.node, convertFragment, fRef);
}

function useOpt(fRef) {
  return RescriptRelay_Fragment.useFragmentOpt(fRef !== undefined ? Caml_option.some(Caml_option.valFromOption(fRef)) : undefined, ViewerClubs_viewer_graphql.node, convertFragment);
}

var Fragment = {
  Types: undefined,
  Operation: undefined,
  convertFragment: convertFragment,
  use: use,
  useOpt: useOpt
};

function getClubInitials(name) {
  var hasCJK = /[\u4E00-\u9FFF\u3040-\u309F\u30A0-\u30FF\uAC00-\uD7AF]/u.test(name);
  if (hasCJK) {
    return name.substring(0, Math.min(2, name.length));
  } else {
    return Core__Array.filterMap(name.trim().split(" "), (function (word) {
                      var trimmed = word.trim();
                      if (trimmed.length > 0) {
                        return trimmed.charAt(0).toUpperCase();
                      }
                      
                    })).slice(0, 3).join("");
  }
}

function getClubColor(name) {
  var hash = Core__Array.reduce(name.split(""), 0, (function (acc, $$char) {
          var code = $$char.charCodeAt(0) | 0;
          return Math.imul(acc, 31) + code | 0;
        }));
  var colors = [
    "bg-blue-500",
    "bg-purple-500",
    "bg-pink-500",
    "bg-red-500",
    "bg-orange-500",
    "bg-yellow-500",
    "bg-green-500",
    "bg-teal-500",
    "bg-cyan-500",
    "bg-indigo-500"
  ];
  var index = Caml_int32.mod_(hash, colors.length);
  return Core__Option.getOr(colors[index], "bg-gray-500");
}

function ViewerClubs(props) {
  var activitySlug = props.activitySlug;
  var data = use(props.viewer);
  var clubs = Core__Array.filterMap(Core__Array.filterMap(Core__Option.getOr(data.clubs.edges, []), (function (edge) {
                  return edge;
                })), (function (edge) {
              return edge.node;
            })).filter(function (club) {
          if (activitySlug !== undefined) {
            return Core__Option.getOr(Core__Option.map(Core__Option.flatMap(club.defaultActivity, (function (activity) {
                                  return activity.slug;
                                })), (function (slug) {
                              return slug === activitySlug;
                            })), false);
          } else {
            return true;
          }
        }).map(function (club) {
        return {
                id: club.id,
                name: Core__Option.getOr(club.name, "Unknown"),
                slug: Core__Option.getOr(club.slug, "")
              };
      });
  if (clubs.length === 0) {
    return null;
  } else {
    return JsxRuntime.jsxs("div", {
                children: [
                  JsxRuntime.jsx("h2", {
                        children: t`my clubs`,
                        className: "text-sm font-semibold text-gray-700 mb-3"
                      }),
                  JsxRuntime.jsx("div", {
                        children: clubs.map(function (club) {
                              var initials = getClubInitials(club.name);
                              var colorClass = getClubColor(club.name);
                              return JsxRuntime.jsxs("a", {
                                          children: [
                                            JsxRuntime.jsx("div", {
                                                  children: initials,
                                                  className: "w-16 h-16 rounded-full " + colorClass + " flex items-center justify-center text-white font-bold text-lg shadow-md group-hover:shadow-lg transition-shadow mb-2"
                                                }),
                                            JsxRuntime.jsx("span", {
                                                  children: club.name,
                                                  className: "text-xs text-center text-gray-700 font-medium line-clamp-2 w-full px-1 group-hover:text-blue-600 transition-colors"
                                                })
                                          ],
                                          className: "flex flex-col items-center min-w-[80px] group",
                                          href: "/clubs/" + club.slug
                                        }, club.id);
                            }),
                        className: "flex overflow-x-auto gap-3 pb-2 -mx-1 px-1 scrollbar-thin scrollbar-thumb-gray-300 scrollbar-track-gray-100"
                      })
                ],
                className: "bg-white mb-4"
              });
  }
}

var make = ViewerClubs;

export {
  Fragment ,
  getClubInitials ,
  getClubColor ,
  make ,
}
/*  Not a pure module */
