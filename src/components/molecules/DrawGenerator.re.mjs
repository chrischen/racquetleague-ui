// Generated by ReScript, PLEASE EDIT WITH CARE

import * as React from "react";
import * as Core__Option from "@rescript/core/src/Core__Option.re.mjs";
import * as LucideReact from "lucide-react";
import * as ConfirmButton from "./ConfirmButton.re.mjs";
import * as JsxRuntime from "react/jsx-runtime";

import { t } from '@lingui/macro'
;

function DrawGenerator(props) {
  var __futureRoundsHaveScores = props.futureRoundsHaveScores;
  var __highlight = props.highlight;
  var __isInitiallyExpanded = props.isInitiallyExpanded;
  var onCourtCountChange = props.onCourtCountChange;
  var onGenerateDraws = props.onGenerateDraws;
  var onStrategyChange = props.onStrategyChange;
  var strategy = props.strategy;
  var hasExistingDraws = props.hasExistingDraws;
  var checkedInPlayerCount = props.checkedInPlayerCount;
  var courtCount = props.courtCount;
  var isInitiallyExpanded = __isInitiallyExpanded !== undefined ? __isInitiallyExpanded : true;
  var highlight = __highlight !== undefined ? __highlight : false;
  var futureRoundsHaveScores = __futureRoundsHaveScores !== undefined ? __futureRoundsHaveScores : false;
  var match = React.useState(function () {
        return isInitiallyExpanded;
      });
  var setIsExpanded = match[1];
  var isExpanded = match[0];
  var match$1 = React.useState(function () {
        return false;
      });
  var setIsHighlighting = match$1[1];
  var isHighlighting = match$1[0];
  React.useEffect((function () {
          if (highlight && !isExpanded) {
            setIsHighlighting(function (param) {
                  return true;
                });
            var timeoutId = setTimeout((function () {
                    setIsHighlighting(function (param) {
                          return false;
                        });
                  }), 2000);
            return (function () {
                      clearTimeout(timeoutId);
                    });
          }
          var timeoutId$1 = setTimeout((function () {
                  setIsHighlighting(function (param) {
                        return false;
                      });
                }), 2000);
          return (function () {
                    clearTimeout(timeoutId$1);
                  });
        }), [
        highlight,
        isExpanded
      ]);
  var strategyOptions = [
    {
      value: "CompetitivePlus",
      label: t`Competitive`,
      description: t`Players will be divided into similar skill level groups that round-robin with teams balanced by skill.`
    },
    {
      value: "Mixed",
      label: t`Mixed`,
      description: t`Round-Robin with teams balanced by skill.`
    },
    {
      value: "Random",
      label: t`Round-Robin`,
      description: t`Classic round-robin draws`
    }
  ];
  var minPlayersRequired = (courtCount << 2);
  var canGenerate = checkedInPlayerCount >= minPlayersRequired;
  var courtText = courtCount === 1 ? "court" : "courts";
  var selectedStrategy = strategyOptions.find(function (opt) {
        return opt.value === strategy;
      });
  var handleIncrement = function () {
    if (courtCount < 10) {
      return onCourtCountChange(courtCount + 1 | 0);
    }
    
  };
  var handleDecrement = function () {
    if (courtCount > 1) {
      return onCourtCountChange(courtCount - 1 | 0);
    }
    
  };
  return JsxRuntime.jsxs("div", {
              children: [
                JsxRuntime.jsx("div", {
                      children: JsxRuntime.jsx("div", {
                            className: "w-full border-t-2 border-dashed border-slate-300"
                          }),
                      "aria-hidden": true,
                      className: "absolute inset-0 flex items-center"
                    }),
                JsxRuntime.jsx("div", {
                      children: JsxRuntime.jsx("div", {
                            children: JsxRuntime.jsxs("div", {
                                  children: [
                                    JsxRuntime.jsxs("button", {
                                          children: [
                                            JsxRuntime.jsxs("div", {
                                                  children: [
                                                    JsxRuntime.jsxs("div", {
                                                          children: [
                                                            hasExistingDraws ? JsxRuntime.jsx(LucideReact.RotateCcw, {
                                                                    className: "w-5 h-5 text-orange-600"
                                                                  }) : JsxRuntime.jsx(LucideReact.Shuffle, {
                                                                    className: "w-5 h-5 text-blue-600"
                                                                  }),
                                                            hasExistingDraws ? JsxRuntime.jsx(LucideReact.ArrowDown, {
                                                                    className: "w-5 h-5 text-orange-600"
                                                                  }) : null
                                                          ],
                                                          className: "flex items-center gap-1"
                                                        }),
                                                    JsxRuntime.jsxs("div", {
                                                          children: [
                                                            JsxRuntime.jsx("h3", {
                                                                  children: hasExistingDraws ? t`Update Future Rounds` : t`Generate Draws`,
                                                                  className: "text-sm font-semibold text-slate-900"
                                                                }),
                                                            JsxRuntime.jsx("p", {
                                                                  children: courtCount.toString() + " " + courtText + " â€¢ " + Core__Option.getOr(Core__Option.map(selectedStrategy, (function (s) {
                                                                              return s.label;
                                                                            })), "") + " " + t`strategy`,
                                                                  className: "text-xs text-slate-600"
                                                                })
                                                          ],
                                                          className: "text-left"
                                                        })
                                                  ],
                                                  className: "flex items-center gap-3"
                                                }),
                                            isExpanded ? JsxRuntime.jsx(LucideReact.ChevronUp, {
                                                    className: "w-5 h-5 text-slate-400"
                                                  }) : JsxRuntime.jsx(LucideReact.ChevronDown, {
                                                    className: "w-5 h-5 text-slate-400"
                                                  })
                                          ],
                                          className: "w-full p-4 flex items-center justify-between transition-colors rounded-lg " + (
                                            isHighlighting && !isExpanded ? (
                                                hasExistingDraws ? "bg-orange-50 hover:bg-orange-100" : "bg-blue-50 hover:bg-blue-100"
                                              ) : "hover:bg-slate-50"
                                          ),
                                          onClick: (function (param) {
                                              setIsExpanded(function (prev) {
                                                    return !prev;
                                                  });
                                            })
                                        }),
                                    isExpanded ? JsxRuntime.jsx("div", {
                                            children: JsxRuntime.jsxs("div", {
                                                  children: [
                                                    JsxRuntime.jsxs("div", {
                                                          children: [
                                                            JsxRuntime.jsxs("div", {
                                                                  children: [
                                                                    JsxRuntime.jsx("span", {
                                                                          children: t`Courts:`,
                                                                          className: "text-sm text-slate-600 font-medium"
                                                                        }),
                                                                    JsxRuntime.jsx("button", {
                                                                          children: JsxRuntime.jsx(LucideReact.Minus, {
                                                                                className: "w-4 h-4"
                                                                              }),
                                                                          className: courtCount <= 1 ? "p-1.5 rounded text-slate-300 cursor-not-allowed" : "p-1.5 rounded text-slate-600 hover:bg-slate-100",
                                                                          disabled: courtCount <= 1,
                                                                          onClick: (function (param) {
                                                                              handleDecrement();
                                                                            })
                                                                        }),
                                                                    JsxRuntime.jsx("div", {
                                                                          children: courtCount.toString(),
                                                                          className: "w-12 text-center text-lg font-semibold text-slate-900"
                                                                        }),
                                                                    JsxRuntime.jsx("button", {
                                                                          children: JsxRuntime.jsx(LucideReact.Plus, {
                                                                                className: "w-4 h-4"
                                                                              }),
                                                                          className: courtCount >= 10 ? "p-1.5 rounded text-slate-300 cursor-not-allowed" : "p-1.5 rounded text-slate-600 hover:bg-slate-100",
                                                                          disabled: courtCount >= 10,
                                                                          onClick: (function (param) {
                                                                              handleIncrement();
                                                                            })
                                                                        })
                                                                  ],
                                                                  className: "flex items-center gap-2"
                                                                }),
                                                            JsxRuntime.jsx("div", {
                                                                  className: "hidden md:block w-px h-8 bg-slate-200"
                                                                }),
                                                            JsxRuntime.jsxs("div", {
                                                                  children: [
                                                                    JsxRuntime.jsx("span", {
                                                                          children: t`Strategy:`,
                                                                          className: "text-sm text-slate-600 font-medium"
                                                                        }),
                                                                    strategyOptions.map(function (option) {
                                                                          return JsxRuntime.jsx("button", {
                                                                                      children: option.label,
                                                                                      className: strategy === option.value ? "px-3 py-1.5 text-sm font-medium rounded transition-colors bg-blue-600 text-white" : "px-3 py-1.5 text-sm font-medium rounded transition-colors bg-slate-100 text-slate-700 hover:bg-slate-200",
                                                                                      onClick: (function (param) {
                                                                                          onStrategyChange(option.value);
                                                                                        })
                                                                                    }, option.label);
                                                                        })
                                                                  ],
                                                                  className: "flex items-center gap-2 flex-wrap"
                                                                }),
                                                            hasExistingDraws ? null : JsxRuntime.jsxs(JsxRuntime.Fragment, {
                                                                    children: [
                                                                      JsxRuntime.jsx("div", {
                                                                            className: "hidden md:block w-px h-8 bg-slate-200"
                                                                          }),
                                                                      JsxRuntime.jsxs("button", {
                                                                            children: [
                                                                              JsxRuntime.jsx(LucideReact.Shuffle, {
                                                                                    className: "w-4 h-4"
                                                                                  }),
                                                                              t`Generate`
                                                                            ],
                                                                            className: canGenerate ? "px-4 py-1.5 rounded font-medium text-sm transition-colors flex items-center gap-2 bg-blue-600 text-white hover:bg-blue-700" : "px-4 py-1.5 rounded font-medium text-sm transition-colors flex items-center gap-2 bg-slate-200 text-slate-400 cursor-not-allowed",
                                                                            disabled: !canGenerate,
                                                                            onClick: (function (param) {
                                                                                onGenerateDraws();
                                                                              })
                                                                          })
                                                                    ]
                                                                  })
                                                          ],
                                                          className: "flex flex-col md:flex-row items-center gap-4"
                                                        }),
                                                    Core__Option.getOr(Core__Option.map(selectedStrategy, (function (selected) {
                                                                return JsxRuntime.jsx("div", {
                                                                            children: selected.description,
                                                                            className: "mt-3 text-sm text-slate-600 italic text-center"
                                                                          });
                                                              })), null),
                                                    canGenerate ? null : JsxRuntime.jsx("div", {
                                                            children: t`Need ${minPlayersRequired.toString()} players for ${courtCount.toString()} ${courtText}. Currently ${checkedInPlayerCount.toString()} checked in.`,
                                                            className: "mt-3 text-xs text-amber-700 bg-amber-50 border border-amber-200 rounded px-3 py-2"
                                                          }),
                                                    hasExistingDraws ? JsxRuntime.jsxs("div", {
                                                            children: [
                                                              futureRoundsHaveScores ? JsxRuntime.jsx(ConfirmButton.make, {
                                                                      button: JsxRuntime.jsxs("button", {
                                                                            children: [
                                                                              JsxRuntime.jsx(LucideReact.RotateCcw, {
                                                                                    className: "w-4 h-4"
                                                                                  }),
                                                                              t`Update Rounds Below`,
                                                                              JsxRuntime.jsx(LucideReact.ArrowDown, {
                                                                                    className: "w-4 h-4"
                                                                                  })
                                                                            ],
                                                                            className: canGenerate ? "w-full px-4 py-2.5 rounded-lg font-semibold text-sm transition-colors flex items-center justify-center gap-2 bg-orange-600 text-white hover:bg-orange-700" : "w-full px-4 py-2.5 rounded-lg font-semibold text-sm transition-colors flex items-center justify-center gap-2 bg-slate-200 text-slate-400 cursor-not-allowed",
                                                                            disabled: !canGenerate
                                                                          }),
                                                                      title: t`Regenerate Rounds?`,
                                                                      description: t`Future rounds have scores entered. Regenerating will delete these scores. Are you sure?`,
                                                                      onConfirmed: (function () {
                                                                          onGenerateDraws();
                                                                        })
                                                                    }) : JsxRuntime.jsxs("button", {
                                                                      children: [
                                                                        JsxRuntime.jsx(LucideReact.RotateCcw, {
                                                                              className: "w-4 h-4"
                                                                            }),
                                                                        t`Update Rounds Below`,
                                                                        JsxRuntime.jsx(LucideReact.ArrowDown, {
                                                                              className: "w-4 h-4"
                                                                            })
                                                                      ],
                                                                      className: canGenerate ? "w-full px-4 py-2.5 rounded-lg font-semibold text-sm transition-colors flex items-center justify-center gap-2 bg-orange-600 text-white hover:bg-orange-700" : "w-full px-4 py-2.5 rounded-lg font-semibold text-sm transition-colors flex items-center justify-center gap-2 bg-slate-200 text-slate-400 cursor-not-allowed",
                                                                      disabled: !canGenerate,
                                                                      onClick: (function (param) {
                                                                          onGenerateDraws();
                                                                        })
                                                                    }),
                                                              JsxRuntime.jsx("p", {
                                                                    children: t`This will delete all future rounds and generate new matches`,
                                                                    className: "text-xs text-orange-700 text-center mt-2"
                                                                  })
                                                            ],
                                                            className: "mt-4 pt-4 border-t border-slate-200"
                                                          }) : null
                                                  ],
                                                  className: "pt-4 border-t border-slate-200"
                                                }),
                                            className: "px-4 pb-4"
                                          }) : null
                                  ],
                                  className: "bg-white rounded-lg border shadow-sm max-w-3xl transition-all duration-300 " + (
                                    isHighlighting && !isExpanded ? (
                                        hasExistingDraws ? "border-orange-400 shadow-orange-200 shadow-lg animate-pulse" : "border-blue-400 shadow-blue-200 shadow-lg animate-pulse"
                                      ) : "border-slate-200"
                                  )
                                }),
                            className: "bg-slate-50 px-4"
                          }),
                      className: "relative flex justify-center"
                    })
              ],
              className: "my-8 relative"
            });
}

var make = DrawGenerator;

export {
  make ,
}
/*  Not a pure module */
